<Window x:Class="WpfClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfClient"
        mc:Ignorable="d"
        Title="Paint"
        Width="1260"
        Height="840"
        MinWidth="1180"
        MinHeight="820"
        Background="{DynamicResource WindowBackgroundBrush}"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Viewbox Stretch="Uniform" StretchDirection="Both">
            <Grid Width="{x:Static local:AppConfig.ScreenWidth}"
                  Height="{x:Static local:AppConfig.ScreenHeight}">
                <Border Width="{x:Static local:AppConfig.ScreenWidth}"
                        Height="{x:Static local:AppConfig.ScreenHeight}"
                        CornerRadius="28"
                        Background="White"
                        Effect="{StaticResource MediumShadow}">
                    <Canvas Width="{x:Static local:AppConfig.ScreenWidth}"
                            Height="{x:Static local:AppConfig.ScreenHeight}">
                        <TextBlock Canvas.Left="32" Canvas.Top="24"
                                   Text="Paint Receiver"
                                   FontSize="32"
                                   FontWeight="SemiBold" />
                        <TextBlock Canvas.Left="32" Canvas.Top="66"
                                   Text="Раскрашивание с управлением джойстиком"
                                   FontSize="16"
                                   Foreground="{StaticResource MutedTextBrush}" />

                        <Border Canvas.Left="32"
                                Canvas.Top="112"
                                Width="260"
                                Height="220"
                                Style="{StaticResource PanelBorderStyle}">
                            <StackPanel>
                                <TextBlock Text="Картинка"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource MutedTextBrush}" />
                                <TextBlock Text="{Binding PictureDisplayName}"
                                           FontSize="22"
                                           FontWeight="SemiBold"
                                           Margin="0,4,0,12" />
                                <StackPanel Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <Border Width="20"
                                            Height="20"
                                            Background="{Binding SelectedColorBrush}"
                                            CornerRadius="10" />
                                    <TextBlock Text="{Binding SelectedColorName}"
                                               FontSize="16"
                                               Margin="10,0,0,0" />
                                    <TextBlock Text="{Binding SelectedColorHex, StringFormat=({0})}"
                                               FontSize="12"
                                               Foreground="{StaticResource MutedTextBrush}"
                                               Margin="8,2,0,0" />
                                </StackPanel>

                                <Separator Margin="0,16,0,16" />

                                <TextBlock Text="Позиция курсора"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource MutedTextBrush}" />
                                <TextBlock Text="{Binding CursorPosition}"
                                           FontSize="16"
                                           Margin="0,4,0,0" />

                                <Border Background="#EBF6EE"
                                        CornerRadius="12"
                                        Padding="12"
                                        Margin="0,16,0,0">
                                    <TextBlock Text="{Binding ConnectionStatus}"
                                               FontSize="13"
                                               Foreground="#2C6333" />
                                </Border>
                            </StackPanel>
                        </Border>

                        <Border Canvas.Left="32"
                                Canvas.Top="350"
                                Width="260"
                                Height="140"
                                Style="{StaticResource PanelBorderStyle}">
                            <StackPanel>
                                <TextBlock Text="Горячие клавиши"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Margin="0,0,0,8" />
                                <TextBlock Text="A/D — выбрать цвет | B — залить фигуру | C — очистить фигуру"
                                           TextWrapping="Wrap"
                                           FontSize="13"
                                           Foreground="{StaticResource MutedTextBrush}" />
                                <TextBlock Text="E — следующая картинка | F — очистить всё"
                                           TextWrapping="Wrap"
                                           FontSize="13"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           Margin="0,6,0,0" />
                            </StackPanel>
                        </Border>

                        <Border Canvas.Left="720"
                                Canvas.Top="32"
                                Width="220"
                                Height="200"
                                Style="{StaticResource PanelBorderStyle}">
                            <StackPanel>
                                <TextBlock Text="Образец"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           Margin="0,0,0,12" />
                                <Border Background="White"
                                        CornerRadius="12"
                                        Height="150">
                                    <Image Source="{Binding ReferenceImage}"
                                           Stretch="Uniform" />
                                </Border>
                            </StackPanel>
                        </Border>

                        <Border Canvas.Left="720"
                                Canvas.Top="250"
                                Width="220"
                                Height="300"
                                Style="{StaticResource PanelBorderStyle}">
                            <Canvas Width="220" Height="300">
                                <TextBlock Canvas.Left="16" Canvas.Top="12"
                                           Text="Цвета"
                                           FontSize="16"
                                           FontWeight="SemiBold" />
                                <ListBox Canvas.Left="16"
                                         Canvas.Top="52"
                                         Width="188"
                                         Height="232"
                                         ItemsSource="{Binding Palette}"
                                         ItemTemplate="{StaticResource PaletteItemTemplate}"
                                         ItemContainerStyle="{StaticResource PaletteItemContainerStyle}"
                                         SelectedIndex="{Binding SelectedColorIndex, Mode=TwoWay}"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                    <ListBox.Resources>
                                        <Style TargetType="ScrollBar" BasedOn="{StaticResource ThinScrollBarStyle}" />
                                    </ListBox.Resources>
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel ItemWidth="56"
                                                       ItemHeight="56"
                                                       MinWidth="56" />
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>
                                </ListBox>
                            </Canvas>
                        </Border>

                        <Border Canvas.Left="720"
                                Canvas.Top="570"
                                Width="220"
                                Height="110"
                                Style="{StaticResource PanelBorderStyle}">
                            <StackPanel>
                                <TextBlock Text="Залитые фигуры"
                                           FontSize="16"
                                           FontWeight="SemiBold" />
                                <TextBlock Text="{Binding FilledCount, StringFormat=Всего: {0}}"
                                           FontSize="12"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           Margin="0,4,0,8" />
                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                              Height="60">
                                    <ItemsControl ItemsSource="{Binding FilledFigures}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="White"
                                                        CornerRadius="10"
                                                        Padding="6"
                                                        Margin="0,0,0,6"
                                                        Effect="{StaticResource SoftShadow}">
                                                    <TextBlock Text="{Binding}"
                                                               FontSize="12" />
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>

                        <Border Canvas.Left="{x:Static local:AppConfig.CanvasLeft}"
                                Canvas.Top="{x:Static local:AppConfig.CanvasTop}"
                                Width="{x:Static local:AppConfig.CanvasWidth}"
                                Height="{x:Static local:AppConfig.CanvasHeight}"
                                CornerRadius="32"
                                Background="#FBFCFF"
                                BorderBrush="#D5DFF1"
                                BorderThickness="2"
                                Effect="{StaticResource SoftShadow}">
                            <Grid>
                                <Image Source="{Binding CanvasImage}"
                                       Stretch="Fill" />
                            </Grid>
                        </Border>

                        <Button Canvas.Left="720"
                                Canvas.Top="520"
                                Width="220"
                                Height="44"
                                Click="OnJoystickModeToggle"
                                Foreground="White"
                                BorderThickness="0"
                                FontSize="12"
                                FontWeight="SemiBold"
                                Background="#9C27B0">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="12"
                                            Padding="12,6">
                                        <ContentPresenter HorizontalAlignment="Center"
                                                          VerticalAlignment="Center" />
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                            <TextBlock Text="{Binding JoystickModeText}"
                                       TextAlignment="Center" />
                        </Button>

                        <Border Canvas.Left="32"
                                Canvas.Top="620"
                                Width="450"
                                Height="44"
                                CornerRadius="12"
                                Background="#EFF3FB"
                                Visibility="{Binding HasStatusMessage, Converter={StaticResource BoolToVisibility}}"
                                Padding="16,8"
                                Effect="{StaticResource SoftShadow}">
                            <TextBlock Text="{Binding StatusMessage}"
                                       FontSize="14" />
                        </Border>

                        <Border Canvas.Left="32"
                                Canvas.Top="620"
                                Width="450"
                                Height="44"
                                CornerRadius="12"
                                Background="#F1F4FA"
                                Visibility="{Binding IsPlaying, Converter={StaticResource BoolToVisibility}}"
                                Padding="12,8"
                                Effect="{StaticResource SoftShadow}">
                            <StackPanel>
                                <ProgressBar Value="{Binding PlaybackProgress}"
                                             Maximum="100"
                                             Height="20"
                                             Margin="0,0,0,4"
                                             Background="#E0E0E0"
                                             Foreground="{StaticResource AccentBrush}"
                                             BorderThickness="0" />
                                <TextBlock Text="{Binding PlaybackProgressText}"
                                           FontSize="11"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Border>

                        <Border Canvas.Left="520"
                                Canvas.Top="620"
                                Width="420"
                                Height="60"
                                CornerRadius="16"
                                Background="#F1F4FA"
                                Padding="12,8"
                                Effect="{StaticResource SoftShadow}">
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                <Button Width="110"
                                        Margin="0,0,8,0"
                                        Click="OnRecordClick">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource ElevatedButtonStyle}">
                                            <Setter Property="Background" Value="#4CAF50" />
                                            <Setter Property="Content" Value="Запись" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsRecording}" Value="True">
                                                    <Setter Property="Background" Value="#FF6B6B" />
                                                    <Setter Property="Content" Value="Остановить" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button Width="100"
                                        Margin="0,0,8,0"
                                        Click="OnPlaybackClick">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource ElevatedButtonStyle}">
                                            <Setter Property="Background" Value="{StaticResource AccentBrush}" />
                                            <Setter Property="Content" Value="Демо" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsPlaying}" Value="True">
                                                    <Setter Property="IsEnabled" Value="False" />
                                                    <Setter Property="Opacity" Value="0.6" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button Width="130"
                                        Margin="0,0,8,0"
                                        Click="OnPauseResumeClick">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource ElevatedButtonStyle}">
                                            <Setter Property="Background" Value="#FF9800" />
                                            <Setter Property="Content" Value="⏸ Пауза" />
                                            <Setter Property="IsEnabled" Value="False" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsPlaying}" Value="True">
                                                    <Setter Property="IsEnabled" Value="True" />
                                                    <Setter Property="Content" Value="⏸ Пауза" />
                                                    <Setter Property="Background" Value="#FF9800" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding IsPaused}" Value="True">
                                                    <Setter Property="IsEnabled" Value="True" />
                                                    <Setter Property="Background" Value="#4CAF50" />
                                                    <Setter Property="Content" Value="▶ Продолжить" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <Button Width="100"
                                        Click="OnStopPlaybackClick">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource ElevatedButtonStyle}">
                                            <Setter Property="Background" Value="#F44336" />
                                            <Setter Property="Content" Value="⏹ Выход" />
                                            <Setter Property="IsEnabled" Value="False" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsPlaying}" Value="True">
                                                    <Setter Property="IsEnabled" Value="True" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </Border>
                    </Canvas>
                </Border>

                <Canvas Width="{x:Static local:AppConfig.ScreenWidth}"
                        Height="{x:Static local:AppConfig.ScreenHeight}"
                        IsHitTestVisible="False">
                    <Ellipse Width="{Binding CursorDiameter}"
                             Height="{Binding CursorDiameter}"
                             Stroke="{StaticResource AccentBrush}"
                             StrokeThickness="2"
                             Canvas.Left="{Binding CursorLeft}"
                             Canvas.Top="{Binding CursorTop}"
                             Fill="{x:Null}" />
                    <Ellipse Width="4"
                             Height="4"
                             Fill="{StaticResource AccentBrush}"
                             Canvas.Left="{Binding CursorInnerLeft}"
                             Canvas.Top="{Binding CursorInnerTop}" />
                </Canvas>
            </Grid>
        </Viewbox>
    </Grid>
</Window>

