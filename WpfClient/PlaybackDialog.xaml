<Window x:Class="WpfClient.PlaybackDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:WpfClient.Controls"
        Title="Выбор сессии для воспроизведения"
        Width="600"
        Height="500"
        MinWidth="500"
        MinHeight="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource WindowBackgroundBrush}">

    <Border Margin="16"
            Background="White"
            CornerRadius="12"
            Effect="{StaticResource MediumShadow}">
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Заголовок -->
            <TextBlock Grid.Row="0"
                       Text="Выберите сессию для воспроизведения:"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Margin="0,0,0,12" />

            <!-- Список сессий -->
            <ListBox x:Name="SessionsListBox"
                     Grid.Row="1"
                     SelectionMode="Single"
                     SelectionChanged="OnSelectionChanged">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <controls:PlaybackSessionItem
                            DeleteRequested="OnItemDeleteRequested" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <!-- Подпись текущей выбранной записи -->
            <TextBlock Grid.Row="2"
                       Margin="0,8,0,0"
                       FontSize="12"
                       Foreground="#555"
                       Text="{Binding ElementName=SessionsListBox, Path=SelectedItem.DrawingKey, StringFormat=Выбрана запись: {0}}">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=SessionsListBox, Path=SelectedItem}"
                                         Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ElementName=SessionsListBox, Path=SelectedItem}">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>

            <!-- Кнопки управления -->
            <StackPanel Grid.Row="3"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,16,0,0">
                <Button Content="Отмена"
                        Click="OnCancelClick"
                        Width="100"
                        Margin="0,0,8,0" />
                <Button x:Name="PlayButton"
                        Content="Воспроизвести"
                        Click="OnPlayClick"
                        Width="150"
                        IsEnabled="False" />
            </StackPanel>
        </Grid>
    </Border>
</Window>
